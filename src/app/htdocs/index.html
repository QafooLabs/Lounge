<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    manifest="/cache.manifest"   
    xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="en"
    lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Lounge - CouchDB example</title>

    <link rel="Stylesheet" type="text/css" href="/styles/bootstrap.css" />
    <link rel="Stylesheet" type="text/css" href="/styles/bootstrap-responsive.css" />
    <link rel="Stylesheet" type="text/css" href="/styles/jquery-ui-1.8.14.css" />
    <link rel="Stylesheet" type="text/css" href="/styles/app.css" />

    <link rel="icon" href="/images/favicon.png" type="image/png" />

</head>
<body>
    <div class="container">
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="brand" href="/">
                        Lounge &mdash; CouchDB Example
                    </a>
                    <div class="nav pull-left">
                        <ul class="nav">
                            <li><a href="/" title="Home"><i class="icon-home icon-white"></i> Home</a></li>
                            <li><a href="/statistics" title="Statistics">Statistics</a></li>
                        </ul>
                    </div>
                    <div class="nav pull-right">
                        <form class="navbar-search" action="/search" method="GET">
                            <input type="text" class="search-query" name="phrase" placeholder="Search" />
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row main">
            <div class="span3">
                <div id="sidebar">
                    <div class="row">
                        <div id="user">
                        </div>
                    </div>
                    <div class="row">
                        <div id="tweet">
                        </div>
                    </div>
                    <div class="row">
                        <div id="stats">
                        </div>
                    </div>
                </div>
            </div>
            <div class="span9">
                <div id="content">
                    <div id="start">
                        <h2>Welcome</h2>
                        <p>This is a small example application, which allows you to <strong>tweet</strong>, but it requires JavaScript enabled in your browser.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="span12 footer">
                <strong>Lounge &mdash; a CouchApp demo</strong> by Kore
            </div>
        </div>
    </div>

    <script type="text/javascript" src="/scripts/vendor/jquery/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/scripts/vendor/jquery/jquery-ui-1.8.14.custom.min.js"></script>
    <script type="text/javascript" src="/scripts/vendor/jquery/jquery.history.js"></script>

    <script type="text/javascript" src="/scripts/vendor/bootstrap/bootstrap.js"></script>

    <script type="text/javascript" src="/scripts/vendor/mustache/mustache.js"></script>

    <script type="text/javascript" src="/scripts/vendor/misc/sha1.js"></script>
    <script type="text/javascript" src="/scripts/vendor/misc/parseUri.js"></script>

    <script type="text/javascript" src="/scripts/vendor/lounge/lounge.util.js"></script>
    <script type="text/javascript" src="/scripts/vendor/lounge/lounge.templating.js"></script>
    <script type="text/javascript" src="/scripts/vendor/lounge/lounge.dispatch.js"></script>
    <script type="text/javascript" src="/scripts/vendor/lounge/lounge.markCurrent.js"></script>
    <script type="text/javascript" src="/scripts/vendor/lounge/lounge.router.js"></script>

    <script type="text/javascript" src="/scripts/lounge.user.js"></script>
    <script type="text/javascript" src="/scripts/lounge.tweets.js"></script>
    <script type="text/javascript" src="/scripts/lounge.app.js"></script>

    <script type="text/javascript">
// <![CDATA[

    function showStatus( target, message, status ) {
        target.innerHTML = '<div class="box">' +
                '<h2>Loading</h2>' +
                '<p>' + message + '</p>' +
                '<div class="progress">' +
                    '<div class="bar" style="width: ' + status + '%">' + status + '%</div>' +
                '</div>' +
            '</div>';
    }

    function emitInitEvent() {
        var event = document.createEvent( "Event" );
        event.initEvent( "init", true, true );
        document.dispatchEvent( event );
    }

    if ( !window.applicationCache ) {
        alert( "Application cache not available. Please update your browser" );
    } else {
        var startBox = document.getElementById( "start" ),
            cache = window.applicationCache;

        cache.addEventListener( "checking", function ( event ) {
            showStatus( startBox, "Checking offline data…", 0 );
        } );

        cache.addEventListener( "downloading", function ( event ) {
            showStatus( startBox, "Starting to download offline data…", 0 );
        } );

        cache.addEventListener( "downloading", function ( event ) {
            console.log( event );
            showStatus( startBox, "Downloading", 0 );
        } );

        cache.addEventListener( "cached", function ( event ) {
            showStatus( startBox, "Finished", 100 );
            emitInitEvent();
        } );

        cache.addEventListener( "noupdate", function ( event ) {
            showStatus( startBox, "Nothing to update", 100 );
            emitInitEvent();
        } );

        cache.addEventListener( "updateready", function ( event ) {
            showStatus( startBox, "Finished", 100 );
            if ( cache.status === cache.UPDATEREADY ) {
                cache.swapCache();
            }
            emitInitEvent();
        } );
    }

// ]]>
    </script>
</body>
</html>
